@{
    var moduleId = ViewBag.ModuleId as Guid?;
    var taskId = ViewBag.TaskId as Guid?;
}

<div class="modal fade" id="editTaskModal" tabindex="-1" aria-labelledby="editTaskModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editTaskModalLabel">Edit Task</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="editTaskForm">
                    <input type="hidden" id="editModuleId" name="moduleId" value="@moduleId" />
                    <input type="hidden" id="editTaskId" name="taskId" value="@taskId" />
                    <input type="hidden" id="editProjectId" name="projectId" value="" />
                    <input type="hidden" id="editWorkspaceId" name="workspaceId" value="" />

                    <div class="mb-3">
                        <label for="editName" class="form-label">Name</label>
                        <input type="text" class="form-control" id="editName" name="name" required>
                    </div>

                    <div class="mb-3">
                        <label for="editDescription" class="form-label">Description</label>
                        <textarea class="form-control" id="editDescription" name="description" rows="5"></textarea>
                    </div>

                    <div class="mb-3">
                        <label for="editSortOrder" class="form-label">Sort Order</label>
                        <input type="number" class="form-control" id="editSortOrder" name="sortOrder" value="1" min="1">
                    </div>

                    <div class="mb-3 form-check">
                        <input type="checkbox" class="form-check-input" id="editIsErd" name="isErd">
                        <label class="form-check-label" for="editIsErd">Is ERD</label>
                    </div>

                    <div class="mb-3" id="editErdDefinitionButton" style="display: none;">
                        <button type="button" class="btn btn-outline-secondary btn-sm" id="editAddErdDefinitionBtn">
                            <i class="fas fa-plus"></i> + ERD Definition
                        </button>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn btn-primary" id="editTaskSubmitBtn">Update</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    // Get workspace ID and project ID from some global variable or API call
    // For now, we'll leave it empty and you can implement as needed
    document.getElementById('editWorkspaceId').value = ''; // You need to set this appropriately
    document.getElementById('editProjectId').value = ''; // You need to set this appropriately

    // Toggle ERD Definition button visibility based on Is ERD checkbox
    document.getElementById('editIsErd').addEventListener('change', function () {
        const erdDefinitionButton = document.getElementById('editErdDefinitionButton');
        if (this.checked) {
            erdDefinitionButton.style.display = 'block';
        } else {
            erdDefinitionButton.style.display = 'none';
        }
    });

    // Handle Add ERD Definition button click
    document.getElementById('editAddErdDefinitionBtn').addEventListener('click', function () {
        alert('Add ERD Definition functionality will be implemented here');
        // Implement the logic to add ERD definition
    });
</script>
